"use strict";const e=require("../../common/vendor.js"),o=require("../../api/index.js");if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-easyinput/uni-easyinput.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-forms-item/uni-forms-item.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-forms/uni-forms.js"))();const s={__name:"login",setup(s){const a=e.ref(null),i=e.ref({email:"",password:""}),n={email:{rules:[{required:!0,errorMessage:"请输入邮箱"},{format:"email",errorMessage:"邮箱格式不正确"}]},password:{rules:[{required:!0,errorMessage:"请输入密码"}]}},r=()=>{a.value.validate().then((async s=>{e.index.showLoading({title:"登录中..."});try{const s=await o.userLogin(i.value);e.index.hideLoading(),200===s.code?(e.index.setStorageSync("access_token",s.data.access_token),e.index.setStorageSync("refresh_token",s.data.refresh_token),e.index.showToast({title:"登录成功",icon:"success"}),setTimeout((()=>{e.index.switchTab({url:"/pages/profile/profile"})}),1500)):e.index.showToast({title:s.message||"登录失败",icon:"none"})}catch(a){e.index.hideLoading(),e.index.showToast({title:"网络错误，请重试",icon:"none"})}})).catch((e=>{console.log("表单错误信息：",e)}))},t=()=>{e.index.navigateTo({url:"/pages/auth/register"})};return(o,s)=>({a:e.o((e=>i.value.email=e)),b:e.p({type:"text",placeholder:"请输入邮箱",modelValue:i.value.email}),c:e.p({label:"邮箱",name:"email"}),d:e.o((e=>i.value.password=e)),e:e.p({type:"password",placeholder:"请输入密码",modelValue:i.value.password}),f:e.p({label:"密码",name:"password"}),g:e.sr(a,"b612e1ba-0",{k:"form"}),h:e.p({modelValue:i.value,rules:n}),i:e.o(r),j:e.o(t)})}},a=e._export_sfc(s,[["__scopeId","data-v-b612e1ba"]]);wx.createPage(a);

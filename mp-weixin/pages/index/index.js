"use strict";const e=require("../../common/vendor.js"),a=require("../../api/index.js"),u=require("../../stores/auth.js");if(!Array){e.resolveComponent("uni-load-more")()}Math;const t={__name:"index",setup(t){const l=e.ref([]),o=e.ref([]),r=e.ref(1),n=e.ref("more"),i=e.ref(!0);let s=!0;u.useAuthStore();const v=async(e=!1)=>{if(e&&(r.value=1,o.value=[],l.value=[],s=!0,n.value="more",i.value=!0),s&&"loading"!==n.value){n.value="loading";try{const u=await a.getNewsList({page:r.value,pageSize:10});if(u&&200===u.code&&Array.isArray(u.data)){const a=u.data;a.length<10?(s=!1,n.value="noMore"):n.value="more",o.value=e?a:[...o.value,...a],e&&a.length>0&&(l.value=a.slice(0,5)),r.value++}else n.value="noMore"}catch(u){n.value="more",console.error("获取新闻列表时捕获到错误:",u)}finally{i.value=!1}}},d=a=>{a&&e.index.navigateTo({url:`/pages/news/detail?uuid=${a}`})},c=e=>{console.error("图片加载失败:",e.detail.errMsg)};return e.onShow((()=>{v(!0)})),e.onPullDownRefresh((()=>{v(!0).then((()=>e.index.stopPullDownRefresh()))})),e.onReachBottom((()=>{v()})),(a,u)=>e.e({a:l.value.length>0},l.value.length>0?{b:e.f(l.value,((a,u,t)=>({a:a.cover_image_url,b:e.t(a.title),c:a.uuid,d:e.o((e=>d(a.uuid)),a.uuid)})))}:{},{c:i.value},i.value?{d:e.p({status:"loading"})}:o.value.length>0?{f:e.f(o.value,((a,u,t)=>{return{a:a.cover_image_url,b:e.o(c,a.uuid),c:e.t(a.title),d:e.t(a.company_name||"未知来源"),e:e.t((l=a.content_created_at,l?l.split(" ")[0]:"")),f:a.uuid,g:e.o((e=>d(a.uuid)),a.uuid)};var l})),g:e.p({status:n.value})}:{},{e:o.value.length>0})}},l=e._export_sfc(t,[["__scopeId","data-v-f3866876"]]);wx.createPage(l);

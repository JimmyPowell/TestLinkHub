"use strict";const e=require("../../common/vendor.js"),a=require("../../api/index.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const l={__name:"detail",setup(l){const r=e.ref(!0),o=e.ref(null),u=e.ref([]),t=e.ref(-1),s=e.computed((()=>t.value>=0&&t.value<u.value.length?u.value[t.value].url:""));e.onLoad((async l=>{if(!l||!l.uuid)return e.index.showToast({title:"缺少课程ID",icon:"error"}),void(r.value=!1);const t=l.uuid;r.value=!0;try{const l=await a.getCourseDetail(t);if(console.log("1. 完整的后端响应 (res):",JSON.parse(JSON.stringify(l||{}))),l&&200===l.code&&l.data){const e=l.data;if(o.value=e,e.resources&&Array.isArray(e.resources)){const a=e.resources.map((e=>({url:e.resources_url,sortOrder:e.sort_order||0})));a.sort(((e,a)=>e.sortOrder-a.sortOrder)),u.value=a}else u.value=[];u.value.length>0&&n(0)}else e.index.showToast({title:l&&l.message||"获取详情失败",icon:"none"}),o.value=null}catch(s){console.error("获取课程详情失败: ",s),e.index.showToast({title:"加载数据时发生错误",icon:"none"}),o.value=null}finally{r.value=!1}}));const n=e=>{t.value=e};return(a,l)=>e.e({a:r.value},r.value?{b:e.p({type:"spinner-cycle",size:"24",color:"#999"})}:o.value?e.e({d:s.value},s.value?{e:s.value,f:o.value.name}:e.e({g:o.value.image_url},o.value.image_url?{h:o.value.image_url}:{},{i:e.p({type:"videocam-filled",size:"50",color:"#fff"})}),{j:e.t(o.value.name),k:e.t(o.value.author_name),l:e.t(o.value.description),m:u.value.length>0},u.value.length>0?{n:e.t(u.value.length),o:e.f(u.value,((a,l,r)=>e.e({a:l===t.value},l===t.value?{b:"f256f264-2-"+r,c:e.p({type:"videocam-filled",size:"20",color:"#007aff"})}:{d:"f256f264-3-"+r,e:e.p({type:"videocam",size:"20",color:"#888"})},{f:e.t(l+1),g:l,h:l===t.value?1:"",i:e.o((e=>n(l)),l)})))}:{}):{},{c:o.value})}},r=e._export_sfc(l,[["__scopeId","data-v-f256f264"]]);wx.createPage(r);
